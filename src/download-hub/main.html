<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <link href="/styles/output.css" rel="stylesheet" />
  <link href="/styles/custom.css" rel="stylesheet" />
  <link href="https://glacier-projects.vercel.app/site-styling/glacier-lxp.css" rel="stylesheet" />
</head>

<body>

  <section class="bg-glacier-darkblue-600 pt-10 sm:pt-16 pb-5">
    <div class="px-4 mx-auto max-w-7xl sm:px-6 lg:px-8">
      <div class="grid items-center grid-cols-1 gap-12 lg:grid-cols-2">
        <div>
          <p class="text-base font-semibold uppercase tracking-widest" style="color: rgb(109, 212, 173);">WELCOME TO DOWNLOAD HUB</p>
          <h1 class="mt-2 my-6 font-bold text-4xl md:text-5xl"  style="color: rgb(109, 212, 173);">Let the downloads begin!</h1>
          <p class="text-white mt-2 text-base">
            Click on each module to access all resources either as a package, or select individual files to download.
            Within each module, you can find different resource types (listed on the right side).
          </p>
          <br />
          <p class="text-white mt-2 text-base">
            Use these resources for your continued climate action in your company, and to inspire others to join us on this journey!
          </p>
        </div>
        <div class="pl-5">
          <h2 class="text-white text-xl font-semibold">Resource types available for you:</h2>
          <div class="flex items-center py-2">
            <div style="width: 50px;" class="flex items-center justify-center">
              <svg width="16" height="21" viewBox="0 0 14 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_88_317)">
                  <path
                    d="M0 2.07812C0 0.931445 0.915104 0 2.04167 0H11.9583C13.0849 0 14 0.931445 14 2.07812V18.0277C14 18.5658 13.5698 19 13.0448 19C12.8479 19 12.6583 18.9369 12.4943 18.8256L7 14.9105L1.50573 18.8256C1.34531 18.9406 1.15208 19 0.955208 19C0.430208 19 0 18.5621 0 18.0277V2.07812ZM2.04167 0.59375C1.23594 0.59375 0.583333 1.25801 0.583333 2.07812V18.0277C0.583333 18.2393 0.751042 18.4062 0.955208 18.4062C1.03177 18.4062 1.10833 18.384 1.17031 18.3357L6.83229 14.302C6.93437 14.2314 7.06563 14.2314 7.16771 14.302L12.8297 18.3357C12.8917 18.3803 12.9682 18.4062 13.0448 18.4062C13.2526 18.4062 13.4167 18.2355 13.4167 18.0277V2.07812C13.4167 1.25801 12.7641 0.59375 11.9583 0.59375H2.04167Z"
                    fill="white" />
                  <rect x="-822" y="-296" width="1474" height="541" fill="#143560" />
                  <g clip-path="url(#clip1_88_317)">
                    <path
                      d="M0 2.07812C0 0.931445 0.915104 0 2.04167 0H11.9583C13.0849 0 14 0.931445 14 2.07812V18.0277C14 18.5658 13.5698 19 13.0448 19C12.8479 19 12.6583 18.9369 12.4943 18.8256L7 14.9105L1.50573 18.8256C1.34531 18.9406 1.15208 19 0.955208 19C0.430208 19 0 18.5621 0 18.0277V2.07812ZM2.04167 0.59375C1.23594 0.59375 0.583333 1.25801 0.583333 2.07812V18.0277C0.583333 18.2393 0.751042 18.4062 0.955208 18.4062C1.03177 18.4062 1.10833 18.384 1.17031 18.3357L6.83229 14.302C6.93437 14.2314 7.06563 14.2314 7.16771 14.302L12.8297 18.3357C12.8917 18.3803 12.9682 18.4062 13.0448 18.4062C13.2526 18.4062 13.4167 18.2355 13.4167 18.0277V2.07812C13.4167 1.25801 12.7641 0.59375 11.9583 0.59375H2.04167Z"
                      fill="white" />
                  </g>
                </g>
                <defs>
                  <clipPath id="clip0_88_317">
                    <rect width="14" height="19" fill="white" />
                  </clipPath>
                  <clipPath id="clip1_88_317">
                    <rect width="14" height="19" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </div>
            <span class="ml-2 text-white">Additional resources</span>
          </div>

          <div class="flex items-center py-2">
            <div style="width: 50px;" class="flex items-center justify-center">
              <svg width="15" height="20" viewBox="0 0 15 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_88_328)">
                  <path
                    d="M12.5 0.625C13.5352 0.625 14.375 1.46484 14.375 2.5V12.9727C14.375 13.0234 14.3711 13.0742 14.3672 13.125H9.6875C8.82422 13.125 8.125 13.8242 8.125 14.6875V19.3672C8.07422 19.375 8.02344 19.375 7.97266 19.375H2.5C1.46484 19.375 0.625 18.5352 0.625 17.5V2.5C0.625 1.46484 1.46484 0.625 2.5 0.625H12.5ZM14.1055 13.75C14.0742 13.7891 14.043 13.8242 14.0117 13.8555L8.85547 19.0078C8.82031 19.043 8.78516 19.0742 8.75 19.1016V14.6875C8.75 14.168 9.16797 13.75 9.6875 13.75H14.1055ZM0 17.5C0 18.8789 1.12109 20 2.5 20H7.97266C8.46875 20 8.94531 19.8008 9.29688 19.4492L14.4492 14.3008C14.8008 13.9492 15 13.4727 15 12.9766V2.5C15 1.12109 13.8789 0 12.5 0H2.5C1.12109 0 0 1.12109 0 2.5V17.5ZM6.78516 2.58984C6.66406 2.46875 6.46484 2.46875 6.34375 2.58984L2.59375 6.33984C2.47266 6.46094 2.47266 6.66016 2.59375 6.78125C2.71484 6.90234 2.91406 6.90234 3.03516 6.78125L6.78516 3.03125C6.90625 2.91016 6.90625 2.71094 6.78516 2.58984ZM10.5352 4.28125C10.6562 4.16016 10.6562 3.96094 10.5352 3.83984C10.4141 3.71875 10.2148 3.71875 10.0938 3.83984L3.84375 10.0898C3.72266 10.2109 3.72266 10.4102 3.84375 10.5312C3.96484 10.6523 4.16406 10.6523 4.28516 10.5312L10.5352 4.28125Z"
                    fill="white" />
                </g>
                <defs>
                  <clipPath id="clip0_88_328">
                    <rect width="18" height="22" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </div>
            <span class="ml-2 text-white">Factsheets</span>
          </div>

          <div class="flex items-center py-2">
            <div style="width: 50px;" class="flex items-center justify-center">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M15.2381 0.375C15.2381 0.16875 15.0667 0 14.8571 0C14.6476 0 14.4762 0.16875 14.4762 0.375V3.75C14.4762 3.95625 14.6476 4.125 14.8571 4.125C15.0667 4.125 15.2381 3.95625 15.2381 3.75V0.375ZM10.0667 1.19531C9.89524 1.31719 9.85714 1.55156 9.97619 1.72031L11.881 4.34531C12.0048 4.51406 12.2429 4.55156 12.4143 4.43437C12.5857 4.31719 12.6238 4.07812 12.5048 3.90938L10.6 1.28437C10.4762 1.11563 10.2381 1.07812 10.0667 1.19531ZM19.6524 1.19531C19.481 1.07344 19.2429 1.11563 19.119 1.28437L17.2143 3.90938C17.0905 4.07812 17.1333 4.3125 17.3048 4.43437C17.4762 4.55625 17.7143 4.51406 17.8381 4.34531L19.7429 1.72031C19.8667 1.55156 19.8238 1.31719 19.6524 1.19531ZM6.94762 6.75C7.27619 6.75 7.59048 6.87656 7.81905 7.10625L14.2048 13.3922C14.2714 13.4578 14.3667 13.5 14.4762 13.5C14.6857 13.5 14.8571 13.3313 14.8571 13.125V9.375C14.8571 8.75156 15.3667 8.25 16 8.25C16.6333 8.25 17.1429 8.75156 17.1429 9.375V16.2C17.1429 20.0953 13.9381 23.25 9.98095 23.25C8.08095 23.25 6.26191 22.5094 4.91905 21.1875L2.9381 19.2328L2.17619 18.4828L1.12381 17.4516C0.890476 17.2219 0.761905 16.9125 0.761905 16.5938C0.761905 15.9187 1.31429 15.375 1.99524 15.375C2.32381 15.375 2.6381 15.5016 2.86667 15.7313L4.68095 17.5172C4.82857 17.6625 5.07143 17.6625 5.21905 17.5172C5.36667 17.3719 5.36667 17.1328 5.21905 16.9875L3.40952 15.2016L1.12381 12.9516C0.890476 12.7219 0.761905 12.4125 0.761905 12.0938C0.761905 11.4187 1.31429 10.875 1.99524 10.875C2.32381 10.875 2.6381 11.0016 2.86667 11.2313L6.96667 15.2672C7.11429 15.4125 7.35714 15.4125 7.50476 15.2672C7.65238 15.1219 7.65238 14.8828 7.50476 14.7375L3.40952 10.7016L2.26667 9.57656C2.03333 9.34688 1.90476 9.0375 1.90476 8.71875C1.90476 8.04375 2.45714 7.5 3.1381 7.5C3.46667 7.5 3.78095 7.62656 4.00952 7.85625L5.53333 9.35625L9.25238 13.0172C9.4 13.1625 9.64286 13.1625 9.79048 13.0172C9.9381 12.8719 9.9381 12.6328 9.79048 12.4875L6.07143 8.82656C5.8381 8.59688 5.70952 8.2875 5.70952 7.96875C5.70952 7.29844 6.26191 6.75469 6.94286 6.75469L6.94762 6.75ZM1.7619 10.1391C0.771429 10.2563 0 11.0859 0 12.0938C0 12.6141 0.209524 13.1156 0.585714 13.4859L1.7619 14.6391C0.771429 14.7562 0 15.5859 0 16.5938C0 17.1141 0.209524 17.6156 0.585714 17.9859L1.6381 19.0219L2.4 19.7719L4.38095 21.7172C5.86667 23.1797 7.88095 24 9.98571 24C14.3571 24 17.9048 20.5078 17.9048 16.2V9.375C17.9048 8.33906 17.0524 7.5 16 7.5C14.9476 7.5 14.0952 8.33906 14.0952 9.375V12.2203L8.36191 6.57656C7.98571 6.20625 7.48095 6 6.94762 6C5.92381 6 5.08095 6.75938 4.9619 7.73438L4.54762 7.32656C4.17619 6.95625 3.67143 6.75 3.1381 6.75C2.0381 6.75 1.14286 7.63125 1.14286 8.71406C1.14286 9.23438 1.35238 9.73594 1.72857 10.1063L1.7619 10.1391ZM20.1905 13.125C20.1905 13.3313 20.3619 13.5 20.5714 13.5C20.781 13.5 20.9524 13.3313 20.9524 13.125V9.375C20.9524 8.75156 21.4619 8.25 22.0952 8.25C22.7286 8.25 23.2381 8.75156 23.2381 9.375V16.2C23.2381 19.6594 20.7095 22.5375 17.3714 23.1328C17.0762 23.4375 16.7619 23.7234 16.4286 23.9906C20.6429 23.8125 24 20.3906 24 16.2V9.375C24 8.33906 23.1476 7.5 22.0952 7.5C21.0429 7.5 20.1905 8.33906 20.1905 9.375V13.125Z"
                  fill="white" />
              </svg>
            </div>
            <span class="ml-2 text-white">Good practice examples</span>
          </div>

          <div class="flex items-center py-2">
            <div style="width: 50px;" class="flex items-center justify-center">
              <svg width="34" height="27" viewBox="0 0 34 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_88_332)">
                  <path
                    d="M2.34281 0.0576722L6.59281 2.58892C6.79469 2.71021 6.85844 2.96861 6.73625 3.169C6.61406 3.36939 6.35375 3.43267 6.15188 3.31138L1.90188 0.780133C1.7 0.658844 1.63625 0.400446 1.75844 0.200055C1.88063 -0.000335647 2.14094 -0.0636169 2.34281 0.0576722ZM32.0928 0.780133L27.8428 3.31138C27.6409 3.43267 27.3806 3.36412 27.2584 3.169C27.1362 2.97388 27.2053 2.71021 27.4019 2.58892L31.6519 0.0576722C31.8538 -0.0636169 32.1141 0.00493778 32.2363 0.200055C32.3584 0.395172 32.2894 0.658844 32.0928 0.780133ZM0.425 8.43716H4.675C4.90875 8.43716 5.1 8.62701 5.1 8.85904C5.1 9.09107 4.90875 9.28091 4.675 9.28091H0.425C0.19125 9.28091 0 9.09107 0 8.85904C0 8.62701 0.19125 8.43716 0.425 8.43716ZM29.325 8.43716H33.575C33.8088 8.43716 34 8.62701 34 8.85904C34 9.09107 33.8088 9.28091 33.575 9.28091H29.325C29.0913 9.28091 28.9 9.09107 28.9 8.85904C28.9 8.62701 29.0913 8.43716 29.325 8.43716ZM6.59281 14.2854L2.34281 16.8167C2.14094 16.9379 1.88063 16.8694 1.75844 16.6743C1.63625 16.4792 1.70531 16.2155 1.90188 16.0942L6.15188 13.5629C6.35375 13.4417 6.61406 13.5102 6.73625 13.7053C6.85844 13.9004 6.78938 14.1641 6.59281 14.2854ZM27.8428 13.5629L32.0928 16.0942C32.2947 16.2155 32.3584 16.4739 32.2363 16.6743C32.1141 16.8747 31.8538 16.9379 31.6519 16.8167L27.4019 14.2854C27.2 14.1641 27.1362 13.9057 27.2584 13.7053C27.3806 13.5049 27.6409 13.4417 27.8428 13.5629ZM23.9859 14.0956C24.9422 12.7297 25.5 11.0739 25.5 9.28619C25.5 4.62447 21.6963 0.848688 17 0.848688C12.3038 0.848688 8.5 4.62447 8.5 9.28619C8.5 11.0739 9.05781 12.7297 10.0141 14.0956C10.2531 14.4383 10.5188 14.7969 10.7844 15.1608C11.4484 16.0678 12.1603 17.0329 12.7128 18.0295C13.1059 18.7415 13.3291 19.4956 13.4566 20.2549H12.5906C12.4738 19.6221 12.2772 19.0051 11.9637 18.4356C11.4378 17.4864 10.7844 16.5952 10.1309 15.704C9.85469 15.3295 9.57844 14.9551 9.31281 14.5754C8.26625 13.0725 7.65 11.2479 7.65 9.28091C7.65 4.15513 11.8363 -0.000335641 17 -0.000335641C22.1637 -0.000335641 26.35 4.15513 26.35 9.28091C26.35 11.2479 25.7338 13.0725 24.6819 14.5702C24.4163 14.9499 24.14 15.3243 23.8638 15.6987C23.2103 16.5846 22.5569 17.4758 22.0309 18.4303C21.7175 18.9999 21.5209 19.6169 21.4041 20.2497H20.5434C20.6709 19.4903 20.8941 18.7362 21.2872 18.0243C21.8397 17.0223 22.5463 16.0573 23.2156 15.1555C23.4813 14.7917 23.7469 14.4331 23.9859 14.0903V14.0956ZM17 26.1559C18.8753 26.1559 20.4 24.6424 20.4 22.7809H13.6C13.6 24.6424 15.1247 26.1559 17 26.1559ZM12.75 22.5014C12.75 22.1903 13.005 21.9372 13.3184 21.9372H20.6816C20.995 21.9372 21.25 22.1903 21.25 22.5014V22.7809C21.25 25.1118 19.3481 26.9997 17 26.9997C14.6519 26.9997 12.75 25.1118 12.75 22.7809V22.5014ZM17.425 5.48404V13.9215C17.425 14.1536 17.2338 14.3434 17 14.3434C16.7663 14.3434 16.575 14.1536 16.575 13.9215V5.48404C16.575 5.25201 16.7663 5.06216 17 5.06216C17.2338 5.06216 17.425 5.25201 17.425 5.48404ZM17 16.0309C17.2254 16.0309 17.4416 16.1198 17.601 16.278C17.7604 16.4363 17.85 16.6509 17.85 16.8747C17.85 17.0984 17.7604 17.3131 17.601 17.4713C17.4416 17.6295 17.2254 17.7184 17 17.7184C16.7746 17.7184 16.5584 17.6295 16.399 17.4713C16.2396 17.3131 16.15 17.0984 16.15 16.8747C16.15 16.6509 16.2396 16.4363 16.399 16.278C16.5584 16.1198 16.7746 16.0309 17 16.0309Z"
                    fill="white" />
                </g>
                <defs>
                  <clipPath id="clip0_88_332">
                    <rect width="34" height="27" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </div>
            <span class="ml-2 text-white">Key takeaways</span>
          </div>

          <div class="flex items-center py-2">
            <div style="width: 50px;" class="flex items-center justify-center">
              <svg width="19" height="22" viewBox="0 0 17 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M16.3929 3.75C16.3929 2.71484 15.577 1.875 14.5714 1.875H2.42857C1.42299 1.875 0.607143 2.71484 0.607143 3.75V16.25C0.607143 17.2852 1.42299 18.125 2.42857 18.125H14.5714C15.577 18.125 16.3929 17.2852 16.3929 16.25V3.75ZM14.5714 1.25C15.9109 1.25 17 2.37109 17 3.75V16.25C17 17.6289 15.9109 18.75 14.5714 18.75H2.42857C1.08906 18.75 0 17.6289 0 16.25V3.75C0 2.37109 1.08906 1.25 2.42857 1.25H14.5714ZM11.752 10.2227L7.19844 14.9102C7.0808 15.0312 6.88728 15.0312 6.76964 14.9102C6.65201 14.7891 6.65201 14.5898 6.76964 14.4688L11.1069 10L6.76585 5.53516C6.64821 5.41406 6.64821 5.21484 6.76585 5.09375C6.88348 4.97266 7.07701 4.97266 7.19464 5.09375L11.7482 9.78125C11.8658 9.90234 11.8658 10.1016 11.7482 10.2227H11.752Z"
                  fill="white" />
              </svg>
            </div>
            <span class="ml-2 text-white">Your next 3 steps</span>
          </div>
        </div>
      </div>

      <div class="flex justify-center pt-10">
        <div 
          class="items-center mx-auto" 
          style="display: inline-flex; align-items: baseline;">
          <div style="width: 50px;" class="flex items-center justify-center">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g clip-path="url(#clip0_88_334)">
                <path
                  d="M22.5 1.5C22.5 5.96719 19.2469 9.675 14.9766 10.3781C15.1031 10.8562 15.1969 11.3484 15.2625 11.85C20.2219 11.0109 24 6.69844 24 1.5V0H22.5H21C17.2031 0 13.875 2.01562 12.0281 5.03906C12.3938 5.42812 12.7359 5.84531 13.05 6.27656C14.5641 3.43594 17.5547 1.5 21 1.5H22.5ZM3 4.5C7.96875 4.5 12 8.53125 12 13.5H10.5C5.53125 13.5 1.5 9.46875 1.5 4.5H3ZM10.5 15H12V23.25V24H13.5V23.25V15V14.25V13.5C13.5 7.70156 8.79844 3 3 3H1.5H0V4.5C0 10.2984 4.70156 15 10.5 15Z"
                  fill="#6DD4AD" />
              </g>
              <defs>
                <clipPath id="clip0_88_334">
                  <rect width="24" height="24" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </div>
          <span class="ml-2 mt-5" style="color: rgb(109, 212, 173);">A climate-friendly reminder: avoid unnecessary
            printing!</span>
        </div>
      </div>
    </div>
  </section>

  <main id="main"></main>

</body>

<script>
  function handleDownloadClick(itemId, itemName) {
    updateMessage('Preparing your download...')
    showLoading()
    const buttons = document.querySelectorAll('#main button')
    buttons.forEach((button) => {
      button.disabled = true
      if (button.id === itemId) {
        button.style.backgroundColor = '#e2e2e2'
        button.style.color = '#717171'
      }
    })

    const userId = window.CONF.preload.currentUser.currentUser.id
    const fetchUrl = 'https://glacier-projects.vercel.app/api/lxp/sharepoint/fetchDownloadLink?itemId=' + itemId + '&userId=' + userId + '&fileName=' + itemName
    fetch(fetchUrl)
      .then((response) => response.json())
      .then((data) => {
        if (data.link) {
          hideLoading()
          window.open(data.link, '_blank')
        }
      })
      .catch((error) => {
        updateMessage('Something went wrong. Please try again later.')
        console.error('Error:', error)
      })

    buttons.forEach((button) => {
      button.disabled = false
    })
  }

  function toggleAccordion(id) {
    const accordion = document.getElementById(`accordion-${id}`);
    if(!accordion){
      console.log(`accordion-${id} not found`)
      return
    }
    const content = accordion.querySelector('.accordion-content');
    const icons = accordion.querySelectorAll('.accordion-icon');

    if (content.style.maxHeight === "0px" || content.style.maxHeight === "") {
      content.classList.remove('accordion-hidden');
      content.style.maxHeight = content.scrollHeight + "px";
      icons.forEach(icon => icon.classList.toggle('hidden'));
    } else {
      content.style.maxHeight = "0px";
      setTimeout(() => {
        content.classList.add('accordion-hidden');
      }, 300);
      icons.forEach(icon => icon.classList.toggle('hidden'));
    }
  }

  function generateHTML(data, index) {
    let html = `
        <section class="py-12 bg-gray-50 sm:py-16 lg:py-20 download-hub-section">
            <div class="px-4 mx-auto max-w-7xl sm:px-6 lg:px-8">
                <div class="max-w-6xl mx-auto">
                    <div class="flex justify-between items-center">
                        <h2 class="text-3xl font-bold mb-5">${data.name}</h2>
                        ${data.folder.zipFile ?
        `
                          <button
                            onclick="handleDownloadClick('${data.folder.zipFile.id}', '${data.folder.zipFile.name}')"
                            id="${data.folder.zipFile.id}"
                            style="border: none; font-weight: 500;"
                            class="inline-flex items-center px-6 py-4 transition-all duration-200 bg-glacier-darkgreen-400 hover-bg-glacier-darkgreen-600 text-glacier-darkblue-600 hover-text-white rounded-full">
                              Download Collection
                          </button>
                          ` : ''
      }
                    </div>
                    <div class="grid gap-12 lg:grid-cols-12 lg:gap-16">
                        <div class="flex flex-col justify-between lg:col-span-5">
                            <div class="lg:max-w-sm">
                                ${data.image ? `<img class="rounded-lg" src="${data.image}" alt="${data.name}">` : ``}
                            </div>
                        </div>
                        <div class="lg:col-span-7">
                            <div class="flow-root">
                                <div class="-my-4 divide-y divide-gray-900">
        `

    data.folder.contents.forEach((category) => {
      if (category?.folder?.contents && category.folder.contents.length > 0) {
        html += `
                                    <div class="py-6" id="accordion-${index}">
                                      <h3>
                                        <button onclick="toggleAccordion(${index})" class="flex items-center justify-between w-full space-x-6 text-base font-bold text-left border-none focus:border-none">
                                          <span class="flex-1">${category.name}</span>
                                          <span class="accordion-icon">
                                            <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                                            </svg>
                                          </span>
                                          <span class="accordion-icon hidden">
                                            <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                            </svg>
                                          </span>
                                        </button>
                                      </h3>
                                      <div class="accordion-content accordion-hidden">
                                        <div class="py-4 text-base font-medium">
                                  `;

        category.folder.contents.forEach((item) => {
          html += `
                                      <button onclick="handleDownloadClick('${item.id}', '${item.name}')" id="${item.id}" class="flex items-center justify-between w-full space-x-6 text-base font-bold text-left border-none focus:border-none p-2 rounded">
                                        <span class="flex-1">${item.name}</span>
                                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                          <path d="M8 22.0002H16C18.8284 22.0002 20.2426 22.0002 21.1213 21.1215C22 20.2429 22 18.8286 22 16.0002V15.0002C22 12.1718 22 10.7576 21.1213 9.8789C20.3529 9.11051 19.175 9.01406 17 9.00195M7 9.00195C4.82497 9.01406 3.64706 9.11051 2.87868 9.87889C2 10.7576 2 12.1718 2 15.0002L2 16.0002C2 18.8286 2 20.2429 2.87868 21.1215C3.17848 21.4213 3.54062 21.6188 4 21.749" stroke="#1C274C" stroke-width="1.5" stroke-linecap="round"/>
                                          <path d="M12 2L12 15M12 15L9 11.5M12 15L15 11.5" stroke="#1C274C" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                      </button>
                                    `;
        });

        html += `
                                        </div>
                                      </div>
                                    </div>
                                  `;
        index++;
      }
    })

    html += `
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>`

    return { html, index }
  }

  async function getData() {
    showLoading()
    updateMessage('Collecting your files...')
    const userId = window.CONF.preload.currentUser.currentUser.id
    const response = await fetch('https://glacier-projects.vercel.app/api/lxp/sharepoint/fetchDownloadables?userId=' + userId)
    const data = await response.json()

    if (data && data.length > 0) {
      let html = ''
      let i = 0
      data.forEach((courseModule) => {
        if (courseModule.folder && courseModule.folder.contents) {
          const props = generateHTML(courseModule, i)
          html += props.html
          i = props.index + 1
        }
      })
      document.getElementById('main').innerHTML = html
    }
    hideLoading()
  }

  getData()
</script>

</html>